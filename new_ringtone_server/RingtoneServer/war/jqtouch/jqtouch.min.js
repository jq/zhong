(function(a){a.jQTouch=function(t){var z,q=a("head"),I="",G=[],E=0,l={},i="",s="portrait",P=true,e=0,h=[],u={},j=351,L=a.jQTouch.prototype.extensions,O=[],p="",A={addGlossToIcon:true,backSelector:".back, .cancel, .goback",cacheGetRequests:true,debug:true,fallback2dAnimation:"fade",fixedViewport:true,formSelector:"form",fullScreen:true,fullScreenClass:"fullscreen",hoverDelay:150,icon:null,icon4:null,moveThreshold:10,preloadImages:false,pressDelay:1000,startupScreen:null,statusBar:"default",submitSelector:".submit",touchSelector:"a, .touch",unloadMessage:"Are you sure you want to leave this page? Doing so will log you out of the app.",useAnimations:true,useTouch:true,animations:[{selector:".cube",name:"cubeleft",is3d:true},{selector:".cubeleft",name:"cubeleft",is3d:true},{selector:".cuberight",name:"cuberight",is3d:true},{selector:".dissolve",name:"fade",is3d:false},{selector:".fade",name:"fade",is3d:false},{selector:".flip",name:"flipleft",is3d:true},{selector:".flipleft",name:"flipleft",is3d:true},{selector:".flipright",name:"flipright",is3d:true},{selector:".pop",name:"pop",is3d:true},{selector:".slide",name:"slideleft",is3d:false},{selector:".slidedown",name:"slidedown",is3d:false},{selector:".slideleft",name:"slideleft",is3d:false},{selector:".slideright",name:"slideright",is3d:false},{selector:".slideup",name:"slideup",is3d:false},{selector:".swap",name:"swapleft",is3d:true},{selector:"#jqt > * > ul li a",name:"slideleft",is3d:false}]};function v(Q){if(l.debug){if(Q){console.log(Q)}else{console.log("Called "+arguments.callee.caller.name)}}}function b(Q){v();if(typeof(Q.selector)==="string"&&typeof(Q.name)==="string"){O.push(Q)}}function k(S,R,Q){v();G.unshift({page:S,animation:R,id:S.attr("id")})}function n(Q){v();if(Q.target.nodeName==="A"){Q.preventDefault()}a(Q.target).trigger("tap")}function c(U,R,T,Q){v();if(R.length===0){a.fn.unselect();v("Target element is missing.");return false}if(R.hasClass("current")){a.fn.unselect();v("You are already on the page you are trying to navigate to.");return false}a(":focus").blur();U.trigger("pageAnimationStart",{direction:"out"});R.trigger("pageAnimationStart",{direction:"in"});if(a.support.animationEvents&&T&&l.useAnimations){P=false;if(!a.support.transform3d&&T.is3d){T.name=l.fallback2dAnimation}if(Q){if(T.name.indexOf("left")>0){finalAnimationName=T.name.replace(/left/,"right")}else{if(T.name.indexOf("right")>0){finalAnimationName=T.name.replace(/right/,"left")}else{if(T.name.indexOf("up")>0){finalAnimationName=T.name.replace(/up/,"down")}else{if(T.name.indexOf("down")>0){finalAnimationName=T.name.replace(/down/,"up")}}}}}else{finalAnimationName=T.name}U.bind("webkitAnimationEnd",S);R.addClass(finalAnimationName+" in current");U.addClass(finalAnimationName+" out")}else{R.addClass("current");S()}function S(V){v();if(a.support.animationEvents&&T&&l.useAnimations){U.unbind("webkitAnimationEnd",S);U.attr("class","");R.attr("class","current")}else{U.attr("class","")}i=R;if(Q){G.shift()}else{k(i,T)}U.unselect();e=(new Date()).getTime();m(i.attr("id"));P=true;R.trigger("pageAnimationEnd",{direction:"in",animation:T});U.trigger("pageAnimationEnd",{direction:"out",animation:T})}return true}function N(){v();return s}function g(){v();if(G.length<1){v("History is empty.")}if(G.length===1){v("You are on the first panel.")}var R=G[0],Q=G[1];if(c(R.page,Q.page,R.animation,true)){return u}else{v("Could not go back.");return false}return false}function K(T,U,R){v();if(R){console.warn("The reverse parameter was sent to goTo() function, which is bad.")}var V=G[0].page;if(typeof U==="string"){for(var S=0,Q=O.length;S<Q;S++){if(O[S].name===U){U=O[S];break}}}if(typeof(T)==="string"){nextPage=a(T);if(nextPage.length<1){d(T,{animation:U});return}else{T=nextPage}}if(c(V,T,U,R)){return u}else{v("Could not animate pages.");return false}}function F(Q){v();if(location.href==G[1].href){g()}else{v(location.href+" == "+G[1].href)}}function M(Q){v();l=a.extend({},A,Q);if(l.preloadImages){for(var R=l.preloadImages.length-1;R>=0;R--){(new Image()).src=l.preloadImages[R]}}if(l.icon||l.icon4){var S,T;if(l.icon4&&window.devicePixelRatio&&window.devicePixelRatio===2){T=l.icon4}else{if(l.icon){T=l.icon}else{T=false}}if(T){S=(l.addGlossToIcon)?"":"-precomposed";p+='<link rel="apple-touch-icon'+S+'" href="'+T+'" />'}}if(l.startupScreen){p+='<link rel="apple-touch-startup-image" href="'+l.startupScreen+'" />'}if(l.fixedViewport){p+='<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"/>'}if(l.fullScreen){p+='<meta name="apple-mobile-web-app-capable" content="yes" />';if(l.statusBar){p+='<meta name="apple-mobile-web-app-status-bar-style" content="'+l.statusBar+'" />'}}if(p){q.prepend(p)}}function x(Q,R){v();var S=null;a(Q).each(function(U,V){var T=a(this);if(!T.attr("id")){T.attr("id","page-"+(++E))}z.trigger("pageInserted",{page:T.appendTo(z)});if(T.hasClass("current")||!S){S=T}});if(S!==null){K(S,R);return S}else{return false}}function w(Q){var R=(new Date()).getTime()-e;if(R<j){return false}}function f(){v();s=Math.abs(window.orientation)==90?"landscape":"portrait";z.removeClass("portrait landscape").addClass(s).trigger("turn",{orientation:s})}function m(Q){v();return;Q=Q.replace(/^#/,""),window.onhashchange=null;if(Q===I){location.href=location.href.split("#")[0]}else{location.hash="#"+Q}window.onhashchange=F}function d(Q,R){v();var T={data:null,method:"GET",animation:null,callback:null,$referrer:null};var S=a.extend({},T,R);if(Q!="#"){a.ajax({url:Q,data:S.data,type:S.method,success:function(U,W){var V=x(U,S.animation);if(V){if(S.method=="GET"&&l.cacheGetRequests===true&&S.$referrer){S.$referrer.attr("href","#"+V.attr("id"))}if(S.callback){S.callback(true)}}},error:function(U){if(S.$referrer){S.$referrer.unselect()}if(S.callback){S.callback(false)}}})}else{if(S.$referrer){S.$referrer.unselect()}}}function C(R,S){v();a(":focus").blur();R.preventDefault();var Q=(typeof(R)==="string")?a(R).eq(0):(R.target?a(R.target):a(R));v(Q.attr("action"));if(Q.length&&Q.is(l.formSelector)&&Q.attr("action")){d(Q.attr("action"),{data:Q.serialize(),method:Q.attr("method")||"POST",animation:O[0]||null,callback:S});return false}return false}function J(S){v();var R=S.closest("form");if(R.length===0){v("No parent form found")}else{v("About to submit parent form");var Q=a.Event("submit");Q.preventDefault();R.trigger(Q);return false}return true}function o(){v();return(typeof WebKitAnimationEvent!="undefined")}function B(){v();return(typeof WebKitCSSMatrix!="undefined")}function H(){v();if(!l.useTouch){return false}if(typeof TouchEvent!="undefined"){if(window.navigator.userAgent.indexOf("Mobile")>-1){return true}else{return false}}else{return false}}function y(){v();var S,R,T,U,Q;S=document.getElementsByTagName("head")[0];R=document.body;T=document.createElement("style");T.textContent="@media (transform-3d),(-o-transform-3d),(-moz-transform-3d),(-ms-transform-3d),(-webkit-transform-3d),(modernizr){#jqtTestFor3dSupport{height:3px}}";U=document.createElement("div");U.id="jqtTestFor3dSupport";S.appendChild(T);R.appendChild(U);Q=U.offsetHeight===3;T.parentNode.removeChild(T);U.parentNode.removeChild(U);return Q}function D(W){v();var S=a(W.target);if(S.attr("nodeName")!=="A"&&S.attr("nodeName")!=="AREA"){S=S.closest("a, area")}var V=S.attr("target"),U=S.attr("hash"),T=null;if(P==false){v("Tap is not ready");return false}if(!S.length){v("Nothing tappable here");return false}if(S.isExternalLink()){S.removeClass("active");return true}if(S.is(l.backSelector)){g(U)}else{if(S.is(l.submitSelector)){J(S)}else{if(V=="_webapp"){window.location=S.attr("href");return false}else{if(S.attr("href")=="#"){S.unselect();return true}else{for(var R=0,Q=O.length;R<Q;R++){if(S.is(O[R].selector)){T=O[R];break}}if(!T){console.warn("Animation could not be found. Using slideleft.");T="slideleft"}if(U&&U!="#"){S.addClass("active");K(a(U).data("referrer",S),T,a(this).hasClass("reverse"));S.trigger({type:"tapped"});return false}else{S.addClass("loading active");d(S.attr("href"),{animation:T,callback:function(){S.removeClass("loading");setTimeout(a.fn.unselect,250,S)},$referrer:S});return false}}}}}}function r(ab){v();var ae=a(ab.target);if(ae.attr("nodeName")!=="A"&&ae.attr("nodeName")!=="AREA"){ae=ae.closest("a, area")}if(!ae.length){v("Could not find a link element.");return}var R=(new Date).getTime(),Q=null,S=null,X,Z,Y,W=0,U=0,aa=0;if(event.changedTouches&&event.changedTouches.length){X=event.changedTouches[0];Z=X.pageX;Y=X.pageY}ae.bind("touchmove",V).bind("touchend",ac).bind("touchcancel",T);Q=setTimeout(function(){ae.makeActive()},l.hoverDelay);S=setTimeout(function(){v("press");ae.trigger("press");ae.unbind("touchmove",V).unbind("touchend",ac).unbind("touchcancel",T);ae.removeClass("active");clearTimeout(Q)},l.pressDelay);function T(af){v();clearTimeout(Q);ae.removeClass("active");ae.unbind("touchmove",V).unbind("touchend",ac).unbind("touchcancel",T)}function V(ai){v();ad();var ah=Math.abs(W);var af=Math.abs(U);var ag;if(ah>af&&(ah>35)&&aa<1000){if(W<0){ag="left"}else{ag="right"}ae.trigger("swipe",{direction:ag,deltaX:W,deltaY:U});ae.unbind("touchmove",V).unbind("touchend",ac).unbind("touchcancel",T)}ae.removeClass("active");clearTimeout(Q);if(ah>l.moveThreshold||af>l.moveThreshold){clearTimeout(S)}}function ac(){v();ad();if(Math.abs(W)<l.moveThreshold&&Math.abs(U)<l.moveThreshold&&aa<l.pressDelay){v("deltaX:"+W+";deltaY:"+U+";");ae.trigger("tap")}else{ae.removeClass("active")}ae.unbind("touchmove",V).unbind("touchend",ac).unbind("touchcancel",T);clearTimeout(Q);clearTimeout(S)}function ad(){v();var af=event.changedTouches[0]||null;W=af.pageX-Z;U=af.pageY-Y;aa=(new Date).getTime()-R}}M(t);a(document).ready(function(){a.support.animationEvents=o();a.support.cssMatrix=B();a.support.touch=H();a.support.transform3d=y();if(!a.support.touch){console.warn("This device does not support touch interaction, or it has been deactivated by the developer. Some features might be unavailable.")}if(!a.support.transform3d){console.warn("This device does not support 3d animation. 2d animations will be used instead.")}a.fn.isExternalLink=function(){var U=a(this);return(U.attr("target")=="_blank"||U.attr("rel")=="external"||U.is('input[type="checkbox"], input[type="radio"], a[href^="http://maps.google.com"], a[href^="mailto:"], a[href^="tel:"], a[href^="javascript:"], a[href*="youtube.com/v"], a[href*="youtube.com/watch"]'))};a.fn.makeActive=function(){return a(this).addClass("active")};a.fn.press=function(U){if(a.isFunction(U)){return a(this).live("press",U)}else{return a(this).trigger("press")}};a.fn.swipe=function(U){if(a.isFunction(U)){return a(this).live("swipe",U)}else{return a(this).trigger("swipe")}};a.fn.tap=function(U){if(a.isFunction(U)){return a(this).live("tap",U)}else{return a(this).trigger("tap")}};a.fn.unselect=function(U){if(U){U.removeClass("active")}else{a(".active").removeClass("active")}};for(var R=0,Q=L.length;R<Q;R++){var S=L[R];if(a.isFunction(S)){a.extend(u,S(u))}}if(l.cubeSelector){console.warn("NOTE: cubeSelector has been deprecated. Please use cubeleftSelector instead.");l.cubeleftSelector=l.cubeSelector}if(l.flipSelector){console.warn("NOTE: flipSelector has been deprecated. Please use flipleftSelector instead.");l.flipleftSelector=l.flipSelector}if(l.slideSelector){console.warn("NOTE: slideSelector has been deprecated. Please use slideleftSelector instead.");l.slideleftSelector=l.slideSelector}for(var R=0,Q=A.animations.length;R<Q;R++){var T=A.animations[R];if(l[T.name+"Selector"]!==undefined){T.selector=l[T.name+"Selector"]}b(T)}h.push("input");h.push(l.touchSelector);h.push(l.backSelector);h.push(l.submitSelector);a(h.join(", ")).css("-webkit-touch-callout","none");z=a("#jqt");if(z.length===0){console.warn('Could not find an element with the id "jqt", so the body id has been set to "jqt". This might cause problems, so you should prolly wrap your panels in a div with the id "jqt".');z=a("body").attr("id","jqt")}if(a.support.transform3d){z.addClass("supports3d")}if(l.fullScreenClass&&window.navigator.standalone==true){z.addClass(l.fullScreenClass+" "+l.statusBar)}if(a.support.touch){z.bind("touchstart",r);z.bind("click",function(){return false})}else{z.bind("click",n)}z.bind("mousedown",w);z.bind("orientationchange",f);z.bind("submit",C);z.bind("tap",D);z.trigger("orientationchange");if(location.hash.length){location.replace(location.href.split("#")[0])}if(a("#jqt > .current").length==0){i=a("#jqt > *:first")}else{i=a("#jqt > .current:first");a("#jqt > .current").removeClass("current")}a(i).addClass("current");m(a(i).attr("id"));I=a(i).attr("id");k(i);scrollTo(0,0)});u={animations:O,hist:G,settings:l,support:a.support,getOrientation:N,goBack:g,goTo:K,addAnimation:b,submitForm:C};return u};a.jQTouch.prototype.extensions=[];a.jQTouch.addExtension=function(b){a.jQTouch.prototype.extensions.push(b)}})(jQuery);